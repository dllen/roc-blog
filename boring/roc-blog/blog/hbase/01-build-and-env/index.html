<!doctype html><html class=scroll-smooth lang=en><head><meta charset=utf-8><link href=/css/style.css rel=stylesheet><link href=/line-awesome/css/line-awesome.min.css rel=stylesheet><script defer src=/js/main.js></script><title>HBase 源码阅读：01. 源码编译与环境搭建 | 码农的自留地</title><body class="bg-white dark:bg-slate-900 transition ease-in-out"><section><div class="sticky top-0 bg-slate-100 dark:bg-slate-800"><div class="container mx-auto px-auto xl:px-0 w-full xl:w-1/2 flex place-content-between py-16 xl:py-8 font-sans text-6xl xl:text-2xl text-slate-900 dark:text-slate-300"><div class=flex><a class="m-0 p-0 text-slate-900 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-200" href=/blog/> /blog </a><a class="m-0 p-0 text-slate-900 hover:text-slate-700 dark:text-slate-300 dark:hover:text-slate-200" href=/blog/hbase/> /hbase </a></div><div class="flex gap-4"><div class="hidden cursor-pointer" id=back-to-top><i class="las la-level-up-alt"></i></div><a href=/><i class="las la-home"></i></a><div class=cursor-pointer id=darkmode-toggle><div class="hidden dark:inline"><i class="las la-sun"></i></div><div class="inline dark:hidden"><i class="las la-moon"></i></div></div></div></div></div><div class="container mx-auto w-full xl:w-1/2 mb-16"><div class="mt-4 font-serif text-slate-600 dark:text-slate-500 text-4xl xl:text-base">2026-01-12</div><h1 class="w-full xl:w-2/3 mt-4 mb-8 font-serif text-8xl xl:text-4xl text-slate-900 dark:text-slate-300">HBase 源码阅读：01. 源码编译与环境搭建</h1><div class="mt-2 mb-6 flex flex-wrap gap-2"></div><div class="w-100 border-t mb-8 border-slate-300 dark:border-slate-700"></div><div class="prose dark:prose-invert prose-pre:rounded-none prose-headings:bg-amber-100 prose-headings:text-slate-800 dark:prose-headings:bg-indigo-900 prose-headings:font-normal dark:prose-headings:text-slate-300 prose-headings:p-2 prose-headings:w-max prose-headings:font-serif prose-2xl xl:prose-base"><p>阅读源码的第一步是能够自己编译并运行代码。本文介绍如何编译 HBase 2.x 源码并在 IntelliJ IDEA 中搭建调试环境。<h2 id=1-zhun-bei-gong-zuo>1. 准备工作</h2><h3 id=1-1-huan-jing-yao-qiu>1.1 环境要求</h3><ul><li><strong>JDK</strong>: JDK 8 (HBase 2.x 主要基于 JDK 8，部分新版本支持 JDK 11)<li><strong>Maven</strong>: 3.6+<li><strong>Git</strong>: 最新版本</ul><h3 id=1-2-huo-qu-yuan-ma>1.2 获取源码</h3><p>推荐从 GitHub 克隆官方仓库，也可以下载 Release 包。<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=shellscript><span class=giallo-l><span style=color:#88c0d0>git</span><span style=color:#a3be8c> clone https://github.com/apache/hbase.git</span></span>
<span class=giallo-l><span style=color:#88c0d0>cd</span><span style=color:#a3be8c> hbase</span></span>
<span class=giallo-l><span style=color:#616e88># 切换到稳定分支，例如 branch-2.5</span></span>
<span class=giallo-l><span style=color:#88c0d0>git</span><span style=color:#a3be8c> checkout branch-2.5</span></span></code></pre><h2 id=2-bian-yi-yuan-ma>2. 编译源码</h2><p>HBase 项目比较庞大，包含很多模块。<h3 id=2-1-wan-zheng-bian-yi>2.1 完整编译</h3><p>跳过测试以加快速度（全量测试可能需要数小时）。<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=shellscript><span class=giallo-l><span style=color:#88c0d0>mvn</span><span style=color:#a3be8c> clean package -DskipTests</span></span></code></pre><p>如果遇到 Checkstyle 或 License 检查报错，可以添加参数忽略：<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=shellscript><span class=giallo-l><span style=color:#88c0d0>mvn</span><span style=color:#a3be8c> clean package -DskipTests -Dcheckstyle.skip=true -Drat.skip=true</span></span></code></pre><h3 id=2-2-chang-jian-bian-yi-wen-ti>2.2 常见编译问题</h3><ul><li><strong>Protobuf 版本</strong>: HBase 严重依赖 Protobuf，确保本地安装了正确版本的 <code>protoc</code>，或者让 Maven 自动下载（通常 Maven 会处理好）。<li><strong>网络问题</strong>: 依赖包下载失败，建议配置阿里云 Maven 镜像。</ul><h2 id=3-idea-huan-jing-da-jian>3. IDEA 环境搭建</h2><h3 id=3-1-dao-ru-xiang-mu>3.1 导入项目</h3><ol><li>打开 IntelliJ IDEA -> File -> Open -> 选择 <code>hbase/pom.xml</code>。<li>选择 “Open as Project”。<li>等待 Maven 索引依赖（可能需要较长时间）。</ol><h3 id=3-2-pei-zhi-code-style>3.2 配置 Code Style</h3><p>为了方便贡献代码，建议导入 HBase 的代码风格配置。<ul><li><code>dev-support/hbase_eclipse_formatter.xml</code></ul><h3 id=3-3-yun-xing-dan-yuan-ce-shi>3.3 运行单元测试</h3><p>随便找一个简单的测试类，例如 <code>TestCellUtil</code>，右键 Run，确保环境正常。<h2 id=4-ben-di-diao-shi-standalone-mode>4. 本地调试 (Standalone Mode)</h2><p>为了调试 Master 和 RegionServer，我们可以直接在 IDEA 中启动它们。HBase 支持 Standalone 模式，不需要依赖外部 HDFS 和 ZK。<h3 id=4-1-qi-dong-master>4.1 启动 Master</h3><p>找到 <code>org.apache.hadoop.hbase.master.HMaster</code> 类。<p><strong>VM Options</strong>:<pre class=giallo style=color:#d8dee9;background-color:#2e3440><code data-lang=plain><span class=giallo-l><span>-Dlog4j.configuration=file:///path/to/hbase/conf/log4j.properties</span></span>
<span class=giallo-l><span>-Dhbase.rootdir=file:///tmp/hbase-root</span></span>
<span class=giallo-l><span>-Dhbase.cluster.distributed=false</span></span></code></pre><h3 id=4-2-yan-zheng>4.2 验证</h3><p>启动成功后，访问 Master UI: <code>http://localhost:16010</code>。<hr><p><strong>Next</strong>: <a href=../02-project-structure/>HBase 源码阅读：02. 项目结构概览</a></div></div></section>