<svg xmlns="http://www.w3.org/2000/svg" width="1080" height="520" viewBox="0 0 1080 520">
  <style>
    .title { font: 700 20px -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial; fill: #222; }
    .tbl { fill: #FFFDF7; stroke: #C68B00; stroke-width: 1.2; }
    .text { font: 600 13px -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial; fill: #333; }
    .col { font: 12px -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial; fill: #555; }
    .arrow { stroke: #777; stroke-width: 1.5; marker-end: url(#ah); }
  </style>
  <defs><marker id="ah" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto"><polygon points="0 0, 8 3, 0 6" fill="#777"/></marker></defs>
  <text x="20" y="30" class="title">库存数据库ER关系与索引</text>

  <!-- inventory_main -->
  <rect x="60" y="80" width="260" height="180" rx="8" class="tbl"/>
  <text x="80" y="105" class="text">inventory_main</text>
  <text x="80" y="130" class="col">id (PK), sku_id, warehouse_id</text>
  <text x="80" y="150" class="col">total, available, locked, reserved</text>
  <text x="80" y="170" class="col">activity_tag, version, updated_at</text>
  <text x="80" y="195" class="col">UNIQUE(sku_id, warehouse_id)</text>

  <!-- inventory_flow -->
  <rect x="400" y="80" width="300" height="180" rx="8" class="tbl"/>
  <text x="420" y="105" class="text">inventory_flow</text>
  <text x="420" y="130" class="col">id (PK), sku_id, warehouse_id</text>
  <text x="420" y="150" class="col">action, delta, biz_order_id</text>
  <text x="420" y="170" class="col">trace_id, operator, created_at</text>
  <text x="420" y="195" class="col">INDEX(sku_id, created_at)</text>

  <!-- inventory_lock -->
  <rect x="760" y="80" width="280" height="180" rx="8" class="tbl"/>
  <text x="780" y="105" class="text">inventory_lock</text>
  <text x="780" y="130" class="col">id (PK), sku_id, warehouse_id</text>
  <text x="780" y="150" class="col">lock_qty, biz_order_id, expire_at</text>
  <text x="780" y="170" class="col">status, created_at</text>
  <text x="780" y="195" class="col">INDEX(biz_order_id)</text>

  <!-- inventory_exception -->
  <rect x="60" y="300" width="320" height="160" rx="8" class="tbl"/>
  <text x="80" y="325" class="text">inventory_exception</text>
  <text x="80" y="350" class="col">id (PK), sku_id, warehouse_id</text>
  <text x="80" y="370" class="col">type, reason, ctx(json), biz_order_id</text>
  <text x="80" y="390" class="col">resolved, created_at</text>

  <!-- warehouse -->
  <rect x="440" y="300" width="260" height="160" rx="8" class="tbl"/>
  <text x="460" y="325" class="text">warehouse</text>
  <text x="460" y="350" class="col">id (PK), name, region</text>
  <text x="460" y="370" class="col">priority, capacity, status, updated_at</text>
  <text x="460" y="390" class="col">INDEX(region, priority)</text>

  <!-- Relations -->
  <line x1="320" y1="140" x2="400" y2="140" class="arrow"/>
  <line x1="660" y1="140" x2="760" y2="140" class="arrow"/>
  <line x1="200" y1="360" x2="200" y2="260" class="arrow"/>
  <line x1="570" y1="300" x2="190" y2="260" class="arrow"/>
</svg>